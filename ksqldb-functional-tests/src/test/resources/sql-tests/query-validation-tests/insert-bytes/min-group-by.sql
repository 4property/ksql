--@test: min-group-by - min integer group by
CREATE STREAM TEST (ID BIGINT KEY, VALUE integer) WITH (kafka_topic='test_topic',value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as MIN FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, -2147483647);
INSERT INTO `TEST` (ID, value) VALUES (0, 5);
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, 100);
INSERT INTO `TEST` (ID, value) VALUES (100, 6);
INSERT INTO `TEST` (ID, value) VALUES (100, 300);
INSERT INTO `TEST` (ID, value) VALUES (0, 2000);
INSERT INTO `TEST` (ID, value) VALUES (0, 100);
ASSERT VALUES `S2` (ID, MIN) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -2147483647);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -2147483647);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -2147483647);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 100);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 6);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 6);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -2147483647);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -2147483647);

--@test: min-group-by - min long group by
CREATE STREAM TEST (ID BIGINT KEY, VALUE bigint) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as MIN FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, -1000000);
INSERT INTO `TEST` (ID, value) VALUES (0, 5);
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, 100);
INSERT INTO `TEST` (ID, value) VALUES (100, 6);
INSERT INTO `TEST` (ID, value) VALUES (100, 300);
INSERT INTO `TEST` (ID, value) VALUES (0, -9223372036854775807);
INSERT INTO `TEST` (ID, value) VALUES (0, 100);
ASSERT VALUES `S2` (ID, MIN) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -1000000);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -1000000);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -1000000);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 100);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 6);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 6);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -9223372036854775807);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -9223372036854775807);

--@test: min-group-by - min double group by
CREATE STREAM TEST (ID BIGINT KEY, VALUE double) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as MIN FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, 179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.0);
INSERT INTO `TEST` (ID, value) VALUES (0, 5.1);
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, 100.1);
INSERT INTO `TEST` (ID, value) VALUES (100, 6.4);
INSERT INTO `TEST` (ID, value) VALUES (100, 300.8);
INSERT INTO `TEST` (ID, value) VALUES (0, -179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.0);
INSERT INTO `TEST` (ID, value) VALUES (0, 100.11);
ASSERT VALUES `S2` (ID, MIN) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, 179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.0);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, 5.1);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, 5.1);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 100.1);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 6.4);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 6.4);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.0);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.0);

--@test: min-group-by - min decimal group by
CREATE STREAM TEST (ID BIGINT KEY, VALUE decimal(4, 2)) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as MIN FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, 21.79);
INSERT INTO `TEST` (ID, value) VALUES (0, 1.10);
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, 10.10);
INSERT INTO `TEST` (ID, value) VALUES (100, 06.40);
INSERT INTO `TEST` (ID, value) VALUES (100, 30.80);
INSERT INTO `TEST` (ID, value) VALUES (0, -01.79);
INSERT INTO `TEST` (ID, value) VALUES (0, 10.11);
ASSERT VALUES `S2` (ID, MIN) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, 21.79);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, 01.10);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, 01.10);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 10.10);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 06.40);
ASSERT VALUES `S2` (ID, MIN) VALUES (100, 06.40);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -01.79);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, -01.79);

--@test: min-group-by - min date group by valid after 7.2.0
CREATE STREAM TEST (ID BIGINT KEY, VALUE DATE) WITH (kafka_topic='test_topic',value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as MIN FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, '-5877641-06-24');
INSERT INTO `TEST` (ID, value) VALUES (0, '1970-01-06');
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, '1970-04-11');
INSERT INTO `TEST` (ID, value) VALUES (100, '1970-01-07');
INSERT INTO `TEST` (ID, value) VALUES (100, '1970-10-28');
INSERT INTO `TEST` (ID, value) VALUES (0, '1975-06-24');
INSERT INTO `TEST` (ID, value) VALUES (0, '1970-04-11');
ASSERT VALUES `S2` (ID, MIN) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '-5877641-06-24');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '-5877641-06-24');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '-5877641-06-24');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '1970-04-11');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '1970-01-07');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '1970-01-07');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '-5877641-06-24');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '-5877641-06-24');

--@test: min-group-by - min timestamp group by valid after 7.2.0
CREATE STREAM TEST (ID BIGINT KEY, VALUE TIMESTAMP) WITH (kafka_topic='test_topic',value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as MIN FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, '1969-12-31T23:59:59.900');
INSERT INTO `TEST` (ID, value) VALUES (0, '1970-01-01T00:00:00.005');
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, '1970-01-01T00:00:00.005');
INSERT INTO `TEST` (ID, value) VALUES (100, '1970-01-01T00:00:00.006');
INSERT INTO `TEST` (ID, value) VALUES (100, '1970-01-01T00:00:00.300');
INSERT INTO `TEST` (ID, value) VALUES (0, '1969-12-07T03:28:36.353');
INSERT INTO `TEST` (ID, value) VALUES (0, '1970-01-01T00:00:00.100');
ASSERT VALUES `S2` (ID, MIN) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '1969-12-31T23:59:59.900');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '1969-12-31T23:59:59.900');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '1969-12-31T23:59:59.900');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '1970-01-01T00:00:00.005');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '1970-01-01T00:00:00.005');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '1970-01-01T00:00:00.005');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '1969-12-07T03:28:36.353');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '1969-12-07T03:28:36.353');

--@test: min-group-by - min time group by valid after 7.2.0
CREATE STREAM TEST (ID BIGINT KEY, VALUE TIME) WITH (kafka_topic='test_topic',value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as MIN FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, '00:00');
INSERT INTO `TEST` (ID, value) VALUES (0, '00:00:02');
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, '00:00');
INSERT INTO `TEST` (ID, value) VALUES (100, '00:00');
INSERT INTO `TEST` (ID, value) VALUES (100, '00:00');
INSERT INTO `TEST` (ID, value) VALUES (0, '00:00');
INSERT INTO `TEST` (ID, value) VALUES (0, '00:00');
ASSERT VALUES `S2` (ID, MIN) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '00:00');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '00:00');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '00:00');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '00:00');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '00:00');
ASSERT VALUES `S2` (ID, MIN) VALUES (100, '00:00');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '00:00');
ASSERT VALUES `S2` (ID, MIN) VALUES (0, '00:00');

--@test: min-group-by - min string group by
CREATE STREAM TEST (ID BIGINT KEY, VALUE STRING) WITH (kafka_topic='test_topic',value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as value FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, 'B');
INSERT INTO `TEST` (ID, value) VALUES (0, 'A');
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, 'E');
INSERT INTO `TEST` (ID, value) VALUES (100, 'C');
INSERT INTO `TEST` (ID, value) VALUES (100, 'G');
INSERT INTO `TEST` (ID, value) VALUES (0, 'F');
INSERT INTO `TEST` (ID, value) VALUES (0, 'D');
ASSERT VALUES `S2` (ID, VALUE) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, NULL);
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'B');
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'A');
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'A');
ASSERT VALUES `S2` (ID, VALUE) VALUES (100, 'E');
ASSERT VALUES `S2` (ID, VALUE) VALUES (100, 'C');
ASSERT VALUES `S2` (ID, VALUE) VALUES (100, 'C');
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'A');
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'A');

--@test: min-group-by - min bytes group by
CREATE STREAM TEST (ID BIGINT KEY, VALUE BYTES) WITH (kafka_topic='test_topic',value_format='AVRO');
CREATE TABLE S2 as SELECT ID, min(value) as value FROM test group by id;
INSERT INTO `TEST` (ID, value) VALUES (1, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (0, 'Qg==');
INSERT INTO `TEST` (ID, value) VALUES (0, 'QQ==');
INSERT INTO `TEST` (ID, value) VALUES (0, NULL);
INSERT INTO `TEST` (ID, value) VALUES (100, 'RQ==');
INSERT INTO `TEST` (ID, value) VALUES (100, 'Qw==');
INSERT INTO `TEST` (ID, value) VALUES (100, 'Rw==');
INSERT INTO `TEST` (ID, value) VALUES (0, 'Rg==');
INSERT INTO `TEST` (ID, value) VALUES (0, 'RA==');
ASSERT VALUES `S2` (ID, VALUE) VALUES (1, NULL);
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, NULL);
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'Qg==');
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'QQ==');
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'QQ==');
ASSERT VALUES `S2` (ID, VALUE) VALUES (100, 'RQ==');
ASSERT VALUES `S2` (ID, VALUE) VALUES (100, 'Qw==');
ASSERT VALUES `S2` (ID, VALUE) VALUES (100, 'Qw==');
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'QQ==');
ASSERT VALUES `S2` (ID, VALUE) VALUES (0, 'QQ==');

