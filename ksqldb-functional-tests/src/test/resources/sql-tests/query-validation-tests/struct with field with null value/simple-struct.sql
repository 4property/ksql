--@test: simple-struct - simple struct select star - AVRO
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE STREAM s1 AS SELECT * FROM orders;
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2.0, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4.0, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6.0, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3.0, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5.0, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2.0, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4.0, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6.0, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3.0, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5.0, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);

--@test: simple-struct - simple struct select star - JSON
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='JSON');
CREATE STREAM s1 AS SELECT * FROM orders;
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2.0, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4.0, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6.0, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3.0, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5.0, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2.0, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4.0, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6.0, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3.0, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5.0, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);

--@test: simple-struct - simple struct select star - PROTOBUF
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='PROTOBUF');
CREATE STREAM s1 AS SELECT * FROM orders;
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2.0, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4.0, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6.0, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3.0, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5.0, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2.0, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4.0, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6.0, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3.0, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
ASSERT VALUES `S1` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5.0, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);

--@test: simple-struct - simple struct read struct as json string - JSON
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid VARCHAR, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='JSON');
CREATE STREAM s1 AS SELECT K, itemid, EXTRACTJSONFIELD(itemid, '$.ITEMID') FROM orders;
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, '{ITEMID=6, CATEGORY={ID=2, NAME=Food}, NAME=Item_6}', 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2.0, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, '{ITEMID=6, CATEGORY={ID=2, NAME=Produce}, NAME=Item_6}', 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4.0, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, '{ITEMID=6, CATEGORY={ID=2, NAME=Produce}, NAME=Item_6}', 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6.0, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, '{ITEMID=2, CATEGORY={ID=1, NAME=Food}, NAME=Item_2}', 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3.0, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, '{ITEMID=5, CATEGORY={ID=1, NAME=Produce}, NAME=Item_5}', 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5.0, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S1` (K, ITEMID, KSQL_COL_0, ROWTIME) VALUES ('0', '{ITEMID:6,CATEGORY:{ID:2,NAME:"Food"},NAME:"Item_6"}', '6', 0);
ASSERT VALUES `S1` (K, ITEMID, KSQL_COL_0, ROWTIME) VALUES ('100', '{ITEMID:6,CATEGORY:{ID:2,NAME:"Produce"},NAME:"Item_6"}', '6', 0);
ASSERT VALUES `S1` (K, ITEMID, KSQL_COL_0, ROWTIME) VALUES ('101', '{ITEMID:6,CATEGORY:{ID:2,NAME:"Produce"},NAME:"Item_6"}', '6', 0);
ASSERT VALUES `S1` (K, ITEMID, KSQL_COL_0, ROWTIME) VALUES ('101', '{ITEMID:2,CATEGORY:{ID:1,NAME:"Food"},NAME:"Item_2"}', '2', 0);
ASSERT VALUES `S1` (K, ITEMID, KSQL_COL_0, ROWTIME) VALUES ('101', '{ITEMID:5,CATEGORY:{ID:1,NAME:"Produce"},NAME:"Item_5"}', '5', 0);

--@test: simple-struct - simple struct select filter - AVRO
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE STREAM S2 AS SELECT K, itemid->name FROM orders where itemid->name = 'Item_6';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('0', 'Item_6', 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('100', 'Item_6', 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('101', 'Item_6', 0);

--@test: simple-struct - simple struct select filter - JSON
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='JSON');
CREATE STREAM S2 AS SELECT K, itemid->name FROM orders where itemid->name = 'Item_6';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('0', 'Item_6', 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('100', 'Item_6', 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('101', 'Item_6', 0);

--@test: simple-struct - simple struct select filter - PROTOBUF
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='PROTOBUF');
CREATE STREAM S2 AS SELECT K, itemid->name FROM orders where itemid->name = 'Item_6';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('0', 'Item_6', 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('100', 'Item_6', 0);
ASSERT VALUES `S2` (K, NAME, ROWTIME) VALUES ('101', 'Item_6', 0);

--@test: simple-struct - simple struct select filter 2 - AVRO
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE STREAM S3 AS SELECT K, itemid->category->id, address->street , address->zipcode as zipcode, address->state as state FROM orders WHERE address->state LIKE '%_9';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S3` (K, STREET, STATE, ID, ZIPCODE, ROWTIME) VALUES ('101', 'STREET_3', 'STATE_9', 2, 287, 0);

--@test: simple-struct - simple struct select filter 2 - JSON
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='JSON');
CREATE STREAM S3 AS SELECT K, itemid->category->id, address->street , address->zipcode as zipcode, address->state as state FROM orders WHERE address->state LIKE '%_9';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S3` (K, STREET, STATE, ID, ZIPCODE, ROWTIME) VALUES ('101', 'STREET_3', 'STATE_9', 2, 287, 0);

--@test: simple-struct - simple struct select filter 2 - PROTOBUF
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='PROTOBUF');
CREATE STREAM S3 AS SELECT K, itemid->category->id, address->street , address->zipcode as zipcode, address->state as state FROM orders WHERE address->state LIKE '%_9';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S3` (K, STREET, STATE, ID, ZIPCODE, ROWTIME) VALUES ('101', 'STREET_3', 'STATE_9', 2, 287, 0);

--@test: simple-struct - simples struct select filter 3 - AVRO
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE STREAM S4 AS SELECT K, itemid->itemid, itemid as iid, itemid->category->name as catname FROM orders WHERE itemid->itemid = 6 OR itemid->category->name = 'Food';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('0', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 'Food', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('100', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 'Produce', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('101', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 'Produce', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('101', 2, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 'Food', 0);

--@test: simple-struct - simples struct select filter 3 - JSON
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='JSON');
CREATE STREAM S4 AS SELECT K, itemid->itemid, itemid as iid, itemid->category->name as catname FROM orders WHERE itemid->itemid = 6 OR itemid->category->name = 'Food';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('0', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 'Food', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('100', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 'Produce', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('101', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 'Produce', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('101', 2, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 'Food', 0);

--@test: simple-struct - simples struct select filter 3 - PROTOBUF
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='PROTOBUF');
CREATE STREAM S4 AS SELECT K, itemid->itemid, itemid as iid, itemid->category->name as catname FROM orders WHERE itemid->itemid = 6 OR itemid->category->name = 'Food';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('0', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 'Food', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('100', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 'Produce', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('101', 6, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 'Produce', 0);
ASSERT VALUES `S4` (K, ITEMID_1, IID, CATNAME, ROWTIME) VALUES ('101', 2, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 'Food', 0);

--@test: simple-struct - simple struct select filter 4 - AVRO
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE STREAM S5 as SELECT K, itemid->itemid * 10 as itemid, concat(itemid->category->name, '_HELLO') as cname, len(address->state) as state_length FROM orders WHERE address->state LIKE '%1' OR address->state LIKE '%9';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S5` (K, ITEMID, STATE_LENGTH, CNAME, ROWTIME) VALUES ('0', 60, 7, 'Food_HELLO', 0);
ASSERT VALUES `S5` (K, ITEMID, STATE_LENGTH, CNAME, ROWTIME) VALUES ('101', 60, 7, 'Produce_HELLO', 0);

--@test: simple-struct - simple struct select filter 4 - JSON
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='JSON');
CREATE STREAM S5 as SELECT K, itemid->itemid * 10 as itemid, concat(itemid->category->name, '_HELLO') as cname, len(address->state) as state_length FROM orders WHERE address->state LIKE '%1' OR address->state LIKE '%9';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S5` (K, ITEMID, STATE_LENGTH, CNAME, ROWTIME) VALUES ('0', 60, 7, 'Food_HELLO', 0);
ASSERT VALUES `S5` (K, ITEMID, STATE_LENGTH, CNAME, ROWTIME) VALUES ('101', 60, 7, 'Produce_HELLO', 0);

--@test: simple-struct - simple struct select filter 4 - PROTOBUF
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='PROTOBUF');
CREATE STREAM S5 as SELECT K, itemid->itemid * 10 as itemid, concat(itemid->category->name, '_HELLO') as cname, len(address->state) as state_length FROM orders WHERE address->state LIKE '%1' OR address->state LIKE '%9';
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(ID:=2, NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, STRUCT(ITEMID:=2, CATEGORY:=STRUCT(ID:=1, NAME:='Food'), NAME:='Item_2'), 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S5` (K, ITEMID, STATE_LENGTH, CNAME, ROWTIME) VALUES ('0', 60, 7, 'Food_HELLO', 0);
ASSERT VALUES `S5` (K, ITEMID, STATE_LENGTH, CNAME, ROWTIME) VALUES ('101', 60, 7, 'Produce_HELLO', 0);

--@test: simple-struct - simple struct select with nulls - AVRO
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='AVRO');
CREATE STREAM S6 as SELECT K, itemid->itemid * 10 as itemid, itemid->category->id as catid, itemid->category as cat FROM orders;
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('0', NULL, 2, STRUCT(ID:=2, NAME:='Food'), 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('100', 60, NULL, NULL, 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('101', 60, NULL, STRUCT(ID:=NULL, NAME:='Produce'), 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('101', NULL, NULL, NULL, 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('101', 50, 1, STRUCT(ID:=1, NAME:='Produce'), 0);

--@test: simple-struct - simple struct select with nulls - JSON
CREATE STREAM orders (K STRING KEY, ordertime bigint, orderid bigint, itemid STRUCT< ITEMID BIGINT, NAME VARCHAR, CATEGORY STRUCT< ID BIGINT, NAME VARCHAR>>, ORDERUNITS double, ARRAYCOL array<double>, MAPCOL map<varchar, double>, address STRUCT < number bigint, street varchar, city varchar, state varchar, zipcode bigint>) WITH (kafka_topic='test_topic', value_format='JSON');
CREATE STREAM S6 as SELECT K, itemid->itemid * 10 as itemid, itemid->category->id as catid, itemid->category as cat FROM orders;
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('0', 1, STRUCT(CATEGORY:=STRUCT(ID:=2, NAME:='Food'), NAME:='Item_6'), 1528224275715, MAP('key3':=3.8688222734507915, 'key2':=5.878674158377773, 'key1':=2.706938954083115), 2, STRUCT(CITY:='CITY_0', STATE:='STATE_1', STREET:='STREET_4', NUMBER:=376, ZIPCODE:=621), ARRAY[6.27276558443913, 8.720822816653817, 4.904955205015469, 0.28466518164817933, 5.276269704236784], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('100', 2, STRUCT(ITEMID:=6, NAME:='Item_6'), 1528224280668, MAP('key3':=0.08025583241041634, 'key2':=7.886688738692968, 'key1':=7.997268326700826), 4, STRUCT(CITY:='CITY_3', STATE:='STATE_6', STREET:='STREET_5', NUMBER:=29, ZIPCODE:=46), ARRAY[5.028181423106411, 4.223556791057725, 7.503771637501132, 1.8346470572995977, 8.628168574256188], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 3, STRUCT(ITEMID:=6, CATEGORY:=STRUCT(NAME:='Produce'), NAME:='Item_6'), 1528224281566, MAP('key3':=8.232202829012866, 'key2':=4.76749034853443, 'key1':=3.908548556676262), 6, STRUCT(CITY:='CITY_9', STATE:='STATE_9', STREET:='STREET_3', NUMBER:=219, ZIPCODE:=287), ARRAY[9.404053021473551, 2.005832055529364, 0.16252060679229574, 8.030440873506674, 2.6822009490877683], 0);
INSERT INTO `ORDERS` (K, ORDERID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 4, 1528224285603, MAP('key3':=8.58507015716884, 'key2':=8.690191464522353, 'key1':=3.966253991851106), 3, STRUCT(CITY:='CITY_3', STATE:='STATE_5', STREET:='STREET_8', NUMBER:=380, ZIPCODE:=866), ARRAY[9.887072401304447, 5.217021497196517, 5.604857288119519, 4.628527278923561, 6.367135367927281], 0);
INSERT INTO `ORDERS` (K, ORDERID, ITEMID, ORDERTIME, MAPCOL, ORDERUNITS, ADDRESS, ARRAYCOL, ROWTIME) VALUES ('101', 5, STRUCT(ITEMID:=5, CATEGORY:=STRUCT(ID:=1, NAME:='Produce'), NAME:='Item_5'), 1528224286568, MAP('key3':=4.9160189684727, 'key2':=1.3876747586974092, 'key1':=6.688854425726891), 5, STRUCT(CITY:='CITY_6', STATE:='STATE_3', STREET:='STREET_8', NUMBER:=294, ZIPCODE:=724), ARRAY[1.6856668854084866, 3.4970511301361484, 9.143163282671962, 2.196065628133206, 4.343961390870502], 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('0', NULL, 2, STRUCT(ID:=2, NAME:='Food'), 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('100', 60, NULL, NULL, 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('101', 60, NULL, STRUCT(ID:=NULL, NAME:='Produce'), 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('101', NULL, NULL, NULL, 0);
ASSERT VALUES `S6` (K, ITEMID, CATID, CAT, ROWTIME) VALUES ('101', 50, 1, STRUCT(ID:=1, NAME:='Produce'), 0);

--@test: simple-struct - simple struct select for ambiguity
CREATE STREAM s (K STRING KEY, s STRUCT<s VARCHAR>) WITH (kafka_topic='test_topic', value_format='json');
CREATE STREAM S7 as SELECT k, s as s1, s.s as s2, s->s as s3, s.s->s as s4 FROM s;
INSERT INTO `S` (K, s, ROWTIME) VALUES ('0', STRUCT(s:='Item_6'), 0);
ASSERT VALUES `S7` (K, S3, S2, S1, S4, ROWTIME) VALUES ('0', 'Item_6', STRUCT(S:='Item_6'), STRUCT(S:='Item_6'), 'Item_6', 0);

--@test: simple-struct - generated name
CREATE STREAM INPUT (K STRING KEY, A STRUCT<B MAP<STRING, STRUCT<C ARRAY<STRUCT<D INT>>>>>) WITH (kafka_topic='test_topic', value_format='json');
CREATE STREAM OUTPUT as SELECT K, A->B['key$Name[]']->C[1]->D FROM INPUT;
INSERT INTO `INPUT` (A) VALUES (STRUCT(B:=MAP('key$Name[]':=STRUCT(C:=ARRAY[STRUCT(D:=1)]))));
ASSERT VALUES `OUTPUT` (D) VALUES (1);

--@test: simple-struct - generated name - quoted identifier
CREATE STREAM INPUT (ROWKEY STRING KEY, `mixedCase` STRUCT<`moreMixedCase` INT>) WITH (kafka_topic='test_topic', value_format='json');
CREATE STREAM OUTPUT as SELECT ROWKEY, `mixedCase`->`moreMixedCase` FROM INPUT;
INSERT INTO `INPUT` (mixedCase) VALUES (STRUCT(moreMixedCase:=1));
ASSERT VALUES `OUTPUT` (moreMixedCase) VALUES (1);
ASSERT stream OUTPUT (ROWKEY STRING KEY, `moreMixedCase` INT) WITH (KAFKA_TOPIC='OUTPUT');

--@test: simple-struct - clashing field name
CREATE STREAM INPUT (ROWKEY STRING KEY, B INT, A STRUCT<B INT>, C STRUCT<B INT>) WITH (kafka_topic='test_topic', value_format='json');
CREATE STREAM OUTPUT as SELECT ROWKEY, B, A->B, C->B FROM INPUT;
INSERT INTO `INPUT` (B, A, C) VALUES (0, STRUCT(B:=1), STRUCT(B:=2));
ASSERT VALUES `OUTPUT` (B, B_1, B_2) VALUES (0, 1, 2);
ASSERT stream OUTPUT (ROWKEY STRING KEY, B INT, B_1 INT, B_2 INT) WITH (KAFKA_TOPIC='OUTPUT');

