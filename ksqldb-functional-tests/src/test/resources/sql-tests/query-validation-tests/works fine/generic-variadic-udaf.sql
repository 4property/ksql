--@test: generic-variadic-udaf - returns decimal
CREATE STREAM INPUT (ID BIGINT KEY, FIRST decimal(5, 1), SECOND integer, THIRD double, FOURTH double, FIFTH double) WITH (kafka_topic='input_topic', value_format='JSON');
CREATE TABLE OUTPUT as SELECT id, GENERIC_VAR_ARG(FIRST, SECOND, THIRD, FOURTH, FIFTH) as RESULT FROM INPUT group by id;
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 6.1, 5, 100.4, 3.2, 7.0);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.3, 1, 1.2, 1.44, 8.9);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, NULL, 5, 1.6, 12.34, 1.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 5.7, 3, 9.1, 0.9, 2.5);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 5.1, NULL, 14.1, 1.2, 6.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.9, 7, 7.6, NULL, 8.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.2, 2, 9.0, 9.8, NULL);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 21.8, 10, NULL, 5.0, 2.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, NULL, 20, 3.8, NULL, 3.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.2, 2, 9.6, 4.3, 4.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 6.3, 1, 10.0, 4.9, 10.4);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.2, 6.3]);

--@test: generic-variadic-udaf - variadic decimal
CREATE STREAM INPUT (ID BIGINT KEY, FIRST double, SECOND integer, THIRD decimal(5, 1), FOURTH decimal(5, 1), FIFTH decimal(5, 1)) WITH (kafka_topic='input_topic', value_format='JSON');
CREATE TABLE OUTPUT as SELECT id, GENERIC_VAR_ARG(FIRST, SECOND, THIRD, FOURTH, FIFTH) as RESULT FROM INPUT group by id;
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 6.1, 5, 100.4, 3.2, 7.0);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.3, 1, 1.2, 1.4, 8.9);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, NULL, 5, 1.6, 12.3, 1.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 5.7, 3, 9.1, 0.9, 2.5);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 5.1, NULL, 14.1, 1.2, 6.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.9, 7, 7.6, NULL, 8.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.2, 2, 9.0, 9.8, NULL);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 21.8, 10, NULL, 5.0, 2.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, NULL, 20, 3.8, NULL, 3.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.2, 2, 9.6, 4.3, 4.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 6.3, 1, 10.0, 4.9, 10.4);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.2, 6.3]);

--@test: generic-variadic-udaf - returns map
CREATE STREAM INPUT (ID BIGINT KEY, FIRST map<string, double>, SECOND integer, THIRD double, FOURTH double, FIFTH double) WITH (kafka_topic='input_topic', value_format='JSON');
CREATE TABLE OUTPUT as SELECT id, GENERIC_VAR_ARG(FIRST, SECOND, THIRD, FOURTH, FIFTH) as RESULT FROM INPUT group by id;
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, MAP('one':=6.1), 5, 100.4, 3.2, 7.0);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, MAP('one':=2.3), 1, 1.2, 1.44, 8.9);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, NULL, 5, 1.6, 12.34, 1.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, MAP('one':=5.7), 3, 9.1, 0.9, 2.5);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, MAP('one':=5.1), NULL, 14.1, 1.2, 6.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, MAP('one':=3.9), 7, 7.6, NULL, 8.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, MAP('one':=2.2), 2, 9.0, 9.8, NULL);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, MAP('one':=21.8), 10, NULL, 5.0, 2.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, NULL, 20, 3.8, NULL, 3.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, MAP('one':=3.2), 2, 9.6, 4.3, 4.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, MAP('one':=6.3), 1, 10.0, 4.9, 10.4);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[MAP('one':=6.1)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[MAP('one':=2.3)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[MAP('one':=6.1)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[MAP('one':=2.3), MAP('one':=5.7)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[MAP('one':=6.1)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[MAP('one':=2.3), MAP('one':=5.7)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[MAP('one':=2.3), MAP('one':=5.7)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[MAP('one':=6.1)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[MAP('one':=2.3), MAP('one':=5.7)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[MAP('one':=2.3), MAP('one':=5.7), MAP('one':=3.2)]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[MAP('one':=2.3), MAP('one':=5.7), MAP('one':=3.2), MAP('one':=6.3)]);

--@test: generic-variadic-udaf - variadic map
CREATE STREAM INPUT (ID BIGINT KEY, FIRST double, SECOND integer, THIRD map<string, double>, FOURTH map<string, double>, FIFTH map<string, double>) WITH (kafka_topic='input_topic', value_format='JSON');
CREATE TABLE OUTPUT as SELECT id, GENERIC_VAR_ARG(FIRST, SECOND, THIRD, FOURTH, FIFTH) as RESULT FROM INPUT group by id;
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 6.1, 5, MAP('one':=100.4), MAP('one':=3.2), MAP('one':=7.0));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.3, 1, MAP('one':=1.2), MAP('one':=1.4), MAP('one':=8.9));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, NULL, 5, MAP('one':=1.6), MAP('one':=12.3), MAP('one':=1.1));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 5.7, 3, MAP('one':=9.1), MAP('one':=0.9), MAP('one':=2.5));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 5.1, NULL, MAP('one':=14.1), MAP('one':=1.2), MAP('one':=6.7));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.9, 7, MAP('one':=7.6), NULL, MAP('one':=8.1));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.2, 2, MAP('one':=9.0), MAP('one':=9.8), NULL);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 21.8, 10, NULL, MAP('one':=5.0), MAP('one':=2.3));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, NULL, 20, MAP('one':=3.8), NULL, MAP('one':=3.3));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.2, 2, MAP('one':=9.6), MAP('one':=4.3), MAP('one':=4.7));
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 6.3, 1, MAP('one':=10.0), MAP('one':=4.9), MAP('one':=10.4));
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.2, 6.3]);

--@test: generic-variadic-udaf - return literal
CREATE STREAM INPUT (ID BIGINT KEY, FIRST decimal(5, 1), SECOND integer, THIRD double, FOURTH double, FIFTH double) WITH (kafka_topic='input_topic', value_format='JSON');
CREATE TABLE OUTPUT as SELECT id, GENERIC_VAR_ARG(6.1, SECOND, THIRD, FOURTH, FIFTH) as RESULT FROM INPUT group by id;
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 6.1, 5, 100.4, 3.2, 7.0);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.3, 1, 1.2, 1.44, 8.9);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, NULL, 5, 1.6, 12.34, 1.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 5.7, 3, 9.1, 0.9, 2.5);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 5.1, NULL, 14.1, 1.2, 6.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.9, 7, 7.6, NULL, 8.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.2, 2, 9.0, 9.8, NULL);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 21.8, 10, NULL, 5.0, 2.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, NULL, 20, 3.8, NULL, 3.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.2, 2, 9.6, 4.3, 4.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 6.3, 1, 10.0, 4.9, 10.4);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1, 6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[6.1, 6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1, 6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[6.1, 6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[6.1, 6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1, 6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[6.1, 6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[6.1, 6.1, 6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[6.1, 6.1, 6.1, 6.1]);

--@test: generic-variadic-udaf - variadic literal
CREATE STREAM INPUT (ID BIGINT KEY, FIRST decimal(5, 1), SECOND integer, THIRD double, FOURTH double, FIFTH double) WITH (kafka_topic='input_topic', value_format='JSON');
CREATE TABLE OUTPUT as SELECT id, GENERIC_VAR_ARG(FIRST, SECOND, CAST(100.4 AS DOUBLE), FOURTH, CAST(7.0 AS DOUBLE)) as RESULT FROM INPUT group by id;
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 6.1, 5, 100.4, 3.2, 7.0);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.3, 1, 1.2, 1.44, 8.9);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, NULL, 5, 1.6, 12.34, 1.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 5.7, 3, 9.1, 0.9, 2.5);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 5.1, NULL, 14.1, 1.2, 6.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.9, 7, 7.6, NULL, 8.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.2, 2, 9.0, 9.8, NULL);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 21.8, 10, NULL, 5.0, 2.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, NULL, 20, 3.8, NULL, 3.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.2, 2, 9.6, 4.3, 4.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 6.3, 1, 10.0, 4.9, 10.4);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 2.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1, 21.8]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 2.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 2.2, 3.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 2.2, 3.2, 6.3]);

--@test: generic-variadic-udaf - no variadic args
CREATE STREAM INPUT (ID BIGINT KEY, FIRST decimal(5, 1), SECOND integer, THIRD double, FOURTH double, FIFTH double) WITH (kafka_topic='input_topic', value_format='JSON');
CREATE TABLE OUTPUT as SELECT id, GENERIC_VAR_ARG(FIRST, SECOND) as RESULT FROM INPUT group by id;
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 6.1, 5, 100.4, 3.2, 7.0);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.3, 1, 1.2, 1.44, 8.9);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, NULL, 5, 1.6, 12.34, 1.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 5.7, 3, 9.1, 0.9, 2.5);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 5.1, NULL, 14.1, 1.2, 6.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.9, 7, 7.6, NULL, 8.1);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 2.2, 2, 9.0, 9.8, NULL);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (0, 21.8, 10, NULL, 5.0, 2.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, NULL, 20, 3.8, NULL, 3.3);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 3.2, 2, 9.6, 4.3, 4.7);
INSERT INTO `INPUT` (ID, FIRST, SECOND, THIRD, FOURTH, FIFTH) VALUES (100, 6.3, 1, 10.0, 4.9, 10.4);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.9]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.9, 2.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (0, ARRAY[6.1, 21.8]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.9, 2.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.9, 2.2, 3.2]);
ASSERT VALUES `OUTPUT` (ID, RESULT) VALUES (100, ARRAY[2.3, 5.7, 3.9, 2.2, 3.2, 6.3]);

--@test: generic-variadic-udaf - wrong argument types
--@expected.error: io.confluent.ksql.util.KsqlException
--@expected.message: Function 'GENERIC_VAR_ARG' does not accept parameters (DECIMAL(5, 1), INTEGER, DOUBLE, STRING, DOUBLE).
CREATE STREAM INPUT (ID BIGINT KEY, FIRST decimal(5, 1), SECOND integer, THIRD double, FOURTH double, FIFTH double) WITH (kafka_topic='input_topic', value_format='JSON');
CREATE TABLE OUTPUT as SELECT id, GENERIC_VAR_ARG(FIRST, SECOND, THIRD, 'hello world', FIFTH) as RESULT FROM INPUT group by id;
